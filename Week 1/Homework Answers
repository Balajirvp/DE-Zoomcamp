--1)

--iidfile string

--2)

winpty docker run -it python:3.9 bash
pip list

--3)

SELECT COUNT(*) 
FROM GREEN_TAXI_DATA
WHERE DATE(LPEP_PICKUP_DATETIME) = '2019-01-15' AND DATE(LPEP_DROPOFF_DATETIME) = '2019-01-15';

--4)

SELECT DISTINCT DATE(LPEP_PICKUP_DATETIME) 
FROM GREEN_TAXI_DATA
WHERE TRIP_DISTANCE = (SELECT MAX(TRIP_DISTANCE) FROM GREEN_TAXI_DATA);

--5)

SELECT PASSENGER_COUNT, COUNT(*) 
FROM GREEN_TAXI_DATA
WHERE PASSENGER_COUNT IN (2,3) AND DATE(LPEP_PICKUP_DATETIME) = '2019-01-01' 
GROUP BY 1;

--6)

WITH LOC AS 
(
  SELECT DISTINCT "LocationID" FROM TAXI_ZONE
  WHERE "Zone" = 'Astoria'
), TIP AS
(
  SELECT MAX(TIP_AMOUNT) FROM GREEN_TAXI_DATA
  WHERE "PULocationID" = (SELECT * FROM LOC)
), LOC_ID AS
(
	SELECT DISTINCT "DOLocationID" 
	FROM GREEN_TAXI_DATA 
	WHERE "PULocationID" = (SELECT * FROM LOC) AND TIP_AMOUNT = (SELECT * FROM TIP)
)

SELECT DISTINCT "Zone" FROM TAXI_ZONE
WHERE "LocationID" = (SELECT * FROM LOC_ID);
